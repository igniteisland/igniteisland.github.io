import{_ as T,c as i,b as t,d as m,t as c,w as D,p as F,h as M,F as R,e as C,n as P,r as h,k as G,C as O,j as U,o as d}from"./index-DxIMDvju.js";const H={name:"TheIslandParlayAccept",setup(){const k="https://script.google.com/macros/s/AKfycbz6aGrnk2PeRgwxiaJYBFxvuEgfxreSULDOkmUPA7Ps_LYFwPE95XgyYiDy6H-SWh9q/exec",a=h(!0),v=h(""),e=h([]),f=h(""),y=h(!0),r=h(4e3);let n=null;const _=async()=>{try{v.value="";const o=await(await fetch(`${k}?feed=1`)).json();if(!o?.ok)throw new Error(o?.error||"Feed returned ok=false");const l=Array.isArray(o.items)?o.items:[];l.sort((u,g)=>new Date(g.timestamp)-new Date(u.timestamp)),e.value=l}catch(s){v.value=s?.message||String(s)}finally{a.value=!1}},p=()=>{b(),y.value&&(n=setInterval(_,r.value))},b=()=>{n&&clearInterval(n),n=null};G(async()=>{await _(),p()}),O(()=>b());const w=s=>s?Object.values(s).reduce((o,l)=>o+Number(l?.worth||0),0):0,I=s=>s?Object.values(s).filter(o=>Number(o?.hit)===1).reduce((o,l)=>o+Number(l?.worth||0),0):0,N=s=>{const o=Object.values(s||{}),l=w(s),u=o.length===3&&o.every(L=>Number(L?.hit)===1),g=l>=650;return u&&g},S=s=>{const o=Number(s);return o===0?"PENDING":o===1?"HIT":"MISS"},x=s=>{try{return new Date(s).toLocaleString()}catch{return s}},A=s=>{const o=[];for(let l=1;l<=3;l++){const u=s?.[String(l)];u&&o.push({id:l,...u})}return o},E=U(()=>{const s=f.value.trim().toLowerCase();return s?e.value.filter(o=>String(o.playerName||"").toLowerCase().includes(s)):e.value});return{loading:a,error:v,items:e,search:f,autoRefresh:y,refreshEveryMs:r,filteredItems:E,loadFeed:_,setAutoRefresh:s=>{y.value=s,p()},setRefreshEveryMs:s=>{r.value=s,p()},totalCost:w,earnedAmount:I,allHit:N,statusLabel:S,prettyTime:x,orderedParlayRows:A}}},j={class:"casino-wrapper"},B={class:"casino-header"},V={class:"left"},W={class:"subline"},Y={key:0},q={key:1},z={class:"time-hint"},J={class:"controls"},K={class:"toggle"},X=["checked"],Q={class:"select-wrap"},Z=["value","disabled"],$={key:0,class:"error"},ee={key:1,class:"loading"},te={key:2,class:"casino-grid"},se={class:"total-cost"},ae={key:0,class:"earned-amount"},re={key:1,class:"returning"},oe={class:"casino-name"},ne={class:"casino-time"},le={class:"parlay-stack"},ie=["title"],de={class:"parlay-text"},ce={class:"parlay-worth"},ue={class:"parlay-status"},he={key:0,class:"missing"};function ve(k,a,v,e,f,y){return d(),i("div",j,[t("div",B,[t("div",V,[a[5]||(a[5]=t("h2",{class:"casino-title"},"Island Parlays (Live)",-1)),t("div",W,[e.loading?(d(),i("span",q,"Getting Parlaysâ€¦")):(d(),i("span",Y,"Showing "+c(e.filteredItems.length)+" cards",1)),a[4]||(a[4]=t("span",{class:"dot-sep"},"â€¢",-1)),t("span",z,"Updated: "+c(new Date().toLocaleTimeString()),1)])]),t("button",{class:"nav-btn",onClick:a[0]||(a[0]=(...r)=>e.loadFeed&&e.loadFeed(...r))},"Refresh")]),t("div",J,[D(t("input",{"onUpdate:modelValue":a[1]||(a[1]=r=>e.search=r),class:"search",placeholder:"Search playerâ€¦",type:"text"},null,512),[[F,e.search]]),t("label",K,[t("input",{type:"checkbox",checked:e.autoRefresh,onChange:a[2]||(a[2]=r=>e.setAutoRefresh(r.target.checked))},null,40,X),a[6]||(a[6]=t("span",null,"Auto-refresh",-1))]),t("label",Q,[a[8]||(a[8]=t("span",{class:"select-label"},"Every",-1)),t("select",{class:"select",value:e.refreshEveryMs,onChange:a[3]||(a[3]=r=>e.setRefreshEveryMs(Number(r.target.value))),disabled:!e.autoRefresh},a[7]||(a[7]=[t("option",{value:2e3},"2s",-1),t("option",{value:4e3},"4s",-1),t("option",{value:7e3},"7s",-1),t("option",{value:12e3},"12s",-1)]),40,Z)])]),e.error?(d(),i("div",$,[M(" âŒ "+c(e.error)+" ",1),a[9]||(a[9]=t("div",{class:"error-hint"}," If this is a CORS/403 issue, youâ€™ll need to fetch through a proxy (Cloudflare Worker) for the feed. ",-1))])):m("",!0),e.loading?(d(),i("div",ee,"Getting Parlaysâ€¦")):(d(),i("div",te,[(d(!0),i(R,null,C(e.filteredItems,r=>(d(),i("div",{key:r.id,class:P(["casino-player",{gold:e.allHit(r.parlayCard)}])},[t("div",se,"ðŸ§¾ "+c(e.totalCost(r.parlayCard)),1),e.earnedAmount(r.parlayCard)>0?(d(),i("div",ae," ðŸ’° "+c(e.earnedAmount(r.parlayCard)),1)):m("",!0),e.allHit(r.parlayCard)?(d(),i("div",re,"RETURNING")):m("",!0),t("div",oe,c(r.playerName),1),t("div",ne,c(e.prettyTime(r.timestamp)),1),t("div",le,[(d(!0),i(R,null,C(e.orderedParlayRows(r.parlayCard),n=>(d(),i("div",{key:n.id,class:P(["parlay-row",{pending:n.hit===0,hit:n.hit===1,miss:n.hit===2}]),title:n.parlay},[t("div",de,c(n.parlay),1),t("div",ce,c(n.worth),1),t("div",ue,c(e.statusLabel(n.hit)),1)],10,ie))),128)),e.orderedParlayRows(r.parlayCard).length<3?(d(),i("div",he," Waiting for all 3 picksâ€¦ ")):m("",!0)])],2))),128))]))])}const _e=T(H,[["render",ve],["__scopeId","data-v-e48c7378"]]);export{_e as default};
