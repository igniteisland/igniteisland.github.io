import{u as j,r as y,k as N,j as w,c as s,f as E,b as e,d as c,w as C,p as I,t as n,F as d,e as p,o as t,n as R,y as F,_ as M}from"./index-htxYH9vT.js";import{n as T}from"./TheIslandNavbar-Bv2Dt9Ny.js";const V={class:"roles-page"},B={class:"roles-header"},U={class:"search-wrap"},$={class:"search-row"},A={key:0,class:"meta-row"},D={class:"meta-pill"},q={key:0,class:"meta-pill"},z={class:"roles-body"},O={class:"roles-sidebar"},G={key:0,class:"sidebar-loading"},H={key:1,class:"sidebar-error"},J={class:"err-msg"},K={key:2,class:"role-list"},P=["onClick"],Q={class:"role-name"},W={key:0,class:"role-mini"},X={class:"roles-content"},Y={key:0,class:"content-state"},Z={key:1,class:"content-state error"},ee={class:"err-msg"},se={key:0,class:"role-detail desktop-only"},te={class:"role-hero"},le={class:"role-hero-top"},oe={class:"role-title"},ae={class:"badge"},ne={key:0,class:"role-flavor"},ie={class:"section-title"},re={class:"bullets"},ce={key:0,class:"hint"},de={key:1,class:"content-state desktop-only"},ue={class:"mobile-only"},ve={key:0,class:"content-state"},_e=["onClick"],he={class:"head-left"},ye={class:"role-card-title"},pe={key:0,class:"role-card-flavor"},ke={class:"head-right"},fe={class:"badge"},me={class:"role-card-body"},ge={class:"section-title"},be={class:"bullets"},we="/data/info/roles.json",Ce=j({__name:"TheIslandNewRoles",setup(Re){const k=y([]),r=y("idle"),f=y(""),h=y(""),u=y(null),v=y({});async function g(){r.value="loading",f.value="";try{const a=await fetch(we);if(!a.ok)throw new Error(`Failed to load roles.json (${a.status})`);const o=await a.json();if(!Array.isArray(o))throw new Error("roles.json must be an array");k.value=o,r.value="ready",o.length&&!u.value&&(u.value=o[0].id,v.value[o[0].id]=!0)}catch(a){r.value="error",f.value=a?.message??"Unknown error loading roles"}}N(g);const m=w(()=>{const a=h.value.trim().toLowerCase();return a?k.value.filter(o=>[o.name,o.flavor??"",...o.sections?.flatMap(i=>[i.title,...i.bullets??[]])??[]].join(" ").toLowerCase().includes(a)):k.value}),_=w(()=>u.value?k.value.find(a=>a.id===u.value)??null:null);function x(a){u.value=a,v.value[a]=!0}function L(a){v.value[a]=!v.value[a],v.value[a]&&(u.value=a)}function S(){h.value=""}return(a,o)=>(t(),s(d,null,[E(T),e("div",V,[e("header",B,[o[1]||(o[1]=e("div",{class:"title-wrap"},[e("h1",{class:"page-title"},"Island Roles"),e("p",{class:"page-subtitle"},"Search, browse, and expand to read full mechanics.")],-1)),e("div",U,[e("div",$,[C(e("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>h.value=l),class:"search",type:"text",placeholder:"Search roles, sections, announcements…",spellcheck:"false"},null,512),[[I,h.value]]),h.value?(t(),s("button",{key:0,class:"btn ghost",onClick:S},"Clear")):c("",!0)]),r.value==="ready"?(t(),s("div",A,[e("span",D,n(m.value.length)+" roles",1),h.value?(t(),s("span",q,"Filtered")):c("",!0)])):c("",!0)])]),e("div",z,[e("aside",O,[o[3]||(o[3]=e("div",{class:"sidebar-title"},"Roles",-1)),r.value==="loading"?(t(),s("div",G," Loading roles… ")):r.value==="error"?(t(),s("div",H,[o[2]||(o[2]=e("div",{class:"err-title"},"Couldn’t load roles",-1)),e("div",J,n(f.value),1),e("button",{class:"btn",onClick:g},"Retry")])):(t(),s("ul",K,[(t(!0),s(d,null,p(m.value,l=>(t(),s("li",{key:l.id,class:R(["role-item",{active:l.id===u.value}]),onClick:i=>x(l.id)},[e("div",Q,n(l.name),1),l.flavor?(t(),s("div",W,n(l.flavor),1)):c("",!0)],10,P))),128))]))]),e("main",X,[r.value==="loading"?(t(),s("div",Y,"Loading roles…")):r.value==="error"?(t(),s("div",Z,[o[4]||(o[4]=e("div",{class:"err-title"},"Couldn’t load roles",-1)),e("div",ee,n(f.value),1),e("button",{class:"btn",onClick:g},"Retry")])):(t(),s(d,{key:2},[_.value?(t(),s("article",se,[e("div",te,[e("div",le,[e("h2",oe,n(_.value.name),1),e("span",ae,n(_.value.sections.length)+" sections",1)]),_.value.flavor?(t(),s("p",ne,n(_.value.flavor),1)):c("",!0)]),(t(!0),s(d,null,p(_.value.sections,l=>(t(),s("section",{key:l.title,class:"role-section"},[e("h3",ie,n(l.title),1),e("ul",re,[(t(!0),s(d,null,p(l.bullets,i=>(t(),s("li",{key:i},n(i),1))),128))])]))),128)),_.value.sections?.length?c("",!0):(t(),s("div",ce," This role has no sections yet. "))])):(t(),s("div",de," Select a role to view details. ")),e("div",ue,[m.value.length?c("",!0):(t(),s("div",ve," No roles match your search. ")),(t(!0),s(d,null,p(m.value,l=>(t(),s("article",{key:l.id,class:"role-card"},[e("button",{class:"role-card-head",onClick:i=>L(l.id)},[e("div",he,[e("div",ye,n(l.name),1),l.flavor?(t(),s("div",pe,n(l.flavor),1)):c("",!0)]),e("div",ke,[e("span",fe,n(l.sections.length),1),e("span",{class:R(["chev",{open:!!v.value[l.id]}])},"▾",2)])],8,_e),C(e("div",me,[(t(!0),s(d,null,p(l.sections,i=>(t(),s("section",{key:i.title,class:"role-section"},[e("h3",ge,n(i.title),1),e("ul",be,[(t(!0),s(d,null,p(i.bullets,b=>(t(),s("li",{key:b},n(b),1))),128))])]))),128))],512),[[F,!!v.value[l.id]]])]))),128))])],64))])])])],64))}}),Se=M(Ce,[["__scopeId","data-v-eec791ac"]]);export{Se as default};
