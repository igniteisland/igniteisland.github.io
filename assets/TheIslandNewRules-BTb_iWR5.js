import{s as F,r as m,j as U,l as S,c as e,f as V,b as s,d as k,t as a,w as j,m as M,F as i,e as c,n as L,y as $,o as t,_ as A}from"./index-Cje-Z0ya.js";import{n as D}from"./TheIslandNavbar-B54B34uH.js";const q={class:"rules-page"},z={class:"rules-header"},G={class:"title-wrap"},H={class:"page-title"},J={key:0,class:"page-subtitle"},K={class:"search-wrap"},O={class:"search-row"},P={key:0,class:"meta-row"},Q={class:"meta-pill"},W={key:0,class:"meta-pill"},X={class:"rules-body"},Y={class:"rules-sidebar"},Z={key:0,class:"sidebar-state"},ee={key:1,class:"sidebar-state error"},te={class:"err-msg"},se={key:2,class:"toc"},le=["onClick"],oe={class:"rules-content",id:"rules-content-scroll"},ne={key:0,class:"content-state"},ae={key:1,class:"content-state error"},re={class:"err-msg"},ie={key:0,class:"desktop-only"},ce={class:"section-hero"},ue={class:"section-title"},de={class:"blocks"},ve={key:0,class:"block text"},_e={key:1,class:"block note"},he={class:"note-text"},ke={key:2,class:"block list"},ye={key:3,class:"block table-wrap"},pe={class:"table"},me={key:1,class:"content-state desktop-only"},fe={class:"mobile-only"},be={key:0,class:"content-state"},we=["onClick"],ge={class:"head-left"},xe={class:"sec-title"},Ce={class:"head-right"},Se={class:"sec-body"},je={key:0,class:"block text"},Le={key:1,class:"block note"},Ne={class:"note-text"},Re={key:2,class:"block list"},Te={key:3,class:"block table-wrap"},Be={class:"table"},Ee="/data/info/rules.json",Ie=F({__name:"TheIslandNewRules",setup(Fe){const v=m(null),_=m("idle"),f=m(""),y=m(""),p=m(null),h=m({});async function w(){_.value="loading",f.value="";try{const o=await fetch(Ee);if(!o.ok)throw new Error(`Failed to load rules.json (${o.status})`);const n=await o.json();if(!n||!Array.isArray(n.sections))throw new Error("rules.json must be an object with a sections array");v.value=n,_.value="ready",n.sections.length&&(p.value=n.sections[0].id,h.value[n.sections[0].id]=!0)}catch(o){_.value="error",f.value=o?.message??"Unknown error loading rules"}}U(w);function N(o){switch(o.type){case"text":case"note":return o.text;case"list":return(o.items??[]).join(" ");case"table":return[o.columns?.join(" "),...(o.rows??[]).flat()].join(" ")}}const b=S(()=>{const o=v.value;if(!o)return[];const n=y.value.trim().toLowerCase();return n?o.sections.map(l=>{const r=l.blocks.filter(u=>N(u).toLowerCase().includes(n));return l.title.toLowerCase().includes(n)||r.length>0?{...l,blocks:l.title.toLowerCase().includes(n)?l.blocks:r}:null}).filter(Boolean):o.sections}),g=S(()=>!v.value||!p.value?null:v.value.sections.find(o=>o.id===p.value)??null);function R(o){p.value=o,h.value[o]=!0;const n=document.getElementById("rules-content-scroll");n&&(n.scrollTop=0)}function T(o){h.value[o]=!h.value[o],h.value[o]&&(p.value=o)}function B(){y.value=""}function E(o){R(o)}return(o,n)=>(t(),e(i,null,[V(D),s("div",q,[s("header",z,[s("div",G,[s("h1",H,a(v.value?.title??"Island Rules"),1),v.value?.version?(t(),e("p",J," v"+a(v.value.version),1)):k("",!0)]),s("div",K,[s("div",O,[j(s("input",{"onUpdate:modelValue":n[0]||(n[0]=l=>y.value=l),class:"search",type:"text",placeholder:"Search rules… (e.g., cooldown, starvation, tie)",spellcheck:"false"},null,512),[[M,y.value]]),y.value?(t(),e("button",{key:0,class:"btn ghost",onClick:B},"Clear")):k("",!0)]),_.value==="ready"&&v.value?(t(),e("div",P,[s("span",Q,a(b.value.length)+" sections",1),y.value?(t(),e("span",W,"Filtered")):k("",!0)])):k("",!0)])]),s("div",X,[s("aside",Y,[n[2]||(n[2]=s("div",{class:"sidebar-title"},"Contents",-1)),_.value==="loading"?(t(),e("div",Z,"Loading rules…")):_.value==="error"?(t(),e("div",ee,[n[1]||(n[1]=s("div",{class:"err-title"},"Couldn’t load rules",-1)),s("div",te,a(f.value),1),s("button",{class:"btn",onClick:w},"Retry")])):(t(),e("ul",se,[(t(!0),e(i,null,c(b.value,l=>(t(),e("li",{key:l.id,class:L(["toc-item",{active:l.id===p.value}]),onClick:r=>E(l.id)},a(l.title),11,le))),128))]))]),s("main",oe,[_.value==="loading"?(t(),e("div",ne,"Loading rules…")):_.value==="error"?(t(),e("div",ae,[n[3]||(n[3]=s("div",{class:"err-title"},"Couldn’t load rules",-1)),s("div",re,a(f.value),1),s("button",{class:"btn",onClick:w},"Retry")])):(t(),e(i,{key:2},[g.value?(t(),e("article",ie,[s("div",ce,[s("h2",ue,a(g.value.title),1)]),s("div",de,[(t(!0),e(i,null,c(g.value.blocks,(l,r)=>(t(),e(i,{key:r},[l.type==="text"?(t(),e("p",ve,a(l.text),1)):l.type==="note"?(t(),e("div",_e,[n[4]||(n[4]=s("strong",{class:"note-label"},"Note",-1)),s("div",he,a(l.text),1)])):l.type==="list"?(t(),e("ul",ke,[(t(!0),e(i,null,c(l.items,d=>(t(),e("li",{key:d},a(d),1))),128))])):l.type==="table"?(t(),e("div",ye,[s("table",pe,[s("thead",null,[s("tr",null,[(t(!0),e(i,null,c(l.columns,d=>(t(),e("th",{key:d},a(d),1))),128))])]),s("tbody",null,[(t(!0),e(i,null,c(l.rows,(d,u)=>(t(),e("tr",{key:u},[(t(!0),e(i,null,c(d,(x,C)=>(t(),e("td",{key:C},a(x),1))),128))]))),128))])])])):k("",!0)],64))),128))])])):(t(),e("div",me," Select a section to view details. ")),s("div",fe,[b.value.length?k("",!0):(t(),e("div",be," No rules match your search. ")),(t(!0),e(i,null,c(b.value,l=>(t(),e("article",{key:l.id,class:"sec-card"},[s("button",{class:"sec-head",onClick:r=>T(l.id)},[s("div",ge,[s("div",xe,a(l.title),1)]),s("div",Ce,[s("span",{class:L(["chev",{open:!!h.value[l.id]}])},"▾",2)])],8,we),j(s("div",Se,[(t(!0),e(i,null,c(l.blocks,(r,d)=>(t(),e(i,{key:d},[r.type==="text"?(t(),e("p",je,a(r.text),1)):r.type==="note"?(t(),e("div",Le,[n[5]||(n[5]=s("strong",{class:"note-label"},"Note",-1)),s("div",Ne,a(r.text),1)])):r.type==="list"?(t(),e("ul",Re,[(t(!0),e(i,null,c(r.items,u=>(t(),e("li",{key:u},a(u),1))),128))])):r.type==="table"?(t(),e("div",Te,[s("table",Be,[s("thead",null,[s("tr",null,[(t(!0),e(i,null,c(r.columns,u=>(t(),e("th",{key:u},a(u),1))),128))])]),s("tbody",null,[(t(!0),e(i,null,c(r.rows,(u,x)=>(t(),e("tr",{key:x},[(t(!0),e(i,null,c(u,(C,I)=>(t(),e("td",{key:I},a(C),1))),128))]))),128))])])])):k("",!0)],64))),128))],512),[[$,!!h.value[l.id]]])]))),128))])],64))])])])],64))}}),Me=A(Ie,[["__scopeId","data-v-b225a0b7"]]);export{Me as default};
